package com.offbynull.portmapper.mappers.upnpigd.externalmessages;

import com.offbynull.portmapper.mappers.upnpigd.externalmessages.ServiceDescriptionUpnpIgdResponse.IdentifiedService;
import com.offbynull.portmapper.mappers.upnpigd.externalmessages.ServiceDescriptionUpnpIgdResponse.ServiceType;
import java.util.Map;
import org.apache.commons.lang3.Range;
import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;
import org.junit.Test;

public class ServiceDescriptionUpnpIgdResponseTest {
    // examples are from http://upnp.org/specs/gw/igd1 and http://upnp.org/specs/gw/igd2

    private static final String WAN_PPP_CONNECTION_1
            = "HTTP/1.1 200 OK\r\n"
            + "Content-Type: text/xml\r\n"
            + "\r\n"
            + "<scpd>\n"
            + "    <serviceStateTable>\n"
            + "        <stateVariable>\n"
            + "          <name>ConnectionType</name>\n"
            + "          <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "          <dataType>string</dataType>\n"
            + "        </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PossibleConnectionTypes</name>\n"
            + "      <dataType>string</dataType>\n"
            + "      <allowedValueList>\n"
            + "        <allowedValue>Unconfigured</allowedValue>\n"
            + "        <allowedValue>IP_Routed</allowedValue>\n"
            + "        <allowedValue>DHCP_Spoofed</allowedValue>\n"
            + "        <allowedValue>PPPoE_Bridged</allowedValue>\n"
            + "        <allowedValue>PPTP_Relay</allowedValue>\n"
            + "        <allowedValue>L2TP_Relay</allowedValue>\n"
            + "        <allowedValue>PPPoE_Relay</allowedValue>\n"
            + "      </allowedValueList>      \n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "        <name>ConnectionStatus</name>\n"
            + "        <dataType>string</dataType>\n"
            + "        <allowedValueList>\n"
            + "            <allowedValue>Unconfigured</allowedValue>\n"
            + "            <allowedValue>Connected</allowedValue>\n"
            + "            <allowedValue>Disconnected</allowedValue>\n"
            + "        </allowedValueList>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "\n"
            + "    <stateVariable>\n"
            + "        <name>Uptime</name>\n"
            + "        <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "        <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>UpstreamMaxBitRate</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>DownstreamMaxBitRate</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>LastConnectionError</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "      <allowedValueList>\n"
            + "        <allowedValue>ERROR_NONE</allowedValue>\n"
            + "      </allowedValueList>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "\n"
            + "     <stateVariable>\n"
            + "     <Optional/>\n"
            + "      <name>AutoDisconnectTime</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "    <Optional/>\n"
            + "      <name>IdleDisconnectTime</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "    <Optional/>\n"
            + "      <name>WarnDisconnectDelay</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>RSIPAvailable</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>NATEnabled</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "        \n"
            + "    <stateVariable>\n"
            + "    <Optional/>\n"
            + "      <name>UserName</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "    <Optional/>\n"
            + "      <name>Password</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "        \n"
            + "    <stateVariable>\n"
            + "    <Optional/>\n"
            + "      <name>PPPEncryptionProtocol</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "    <Optional/>\n"
            + "      <name>PPPCompressionProtocol</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "    <Optional/>\n"
            + "      <name>PPPAuthenticationProtocol</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>ExternalIPAddress</name>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingNumberOfEntries</name>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingEnabled</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingLeaseDuration</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>RemoteHost</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>ExternalPort</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>InternalPort</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingProtocol</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "      <allowedValueList>\n"
            + "        <allowedValue>TCP</allowedValue>\n"
            + "	    <allowedValue>UDP</allowedValue>\n"
            + "      </allowedValueList>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>InternalClient</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingDescription</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "  </serviceStateTable>\n"
            + "\n"
            + "  <actionList>\n"
            + "   <action>\n"
            + "    <name>SetConnectionType</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewConnectionType</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ConnectionType</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "     \n"
            + "    <action>\n"
            + "    <name>GetConnectionTypeInfo</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewConnectionType</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>ConnectionType</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPossibleConnectionTypes</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PossibleConnectionTypes</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>ConfigureConnection</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewUserName</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>UserName</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPassword</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>Password</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>RequestConnection</name>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>RequestTermination</name>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>ForceTermination</name>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>SetAutoDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewAutoDisconnectTime</name>\n"
            + "          <direction>in</direction>\n"
            + "         <relatedStateVariable>AutoDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>SetIdleDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewIdleDisconnectTime</name>\n"
            + "          <direction>in</direction>\n"
            + "         <relatedStateVariable>IdleDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>SetWarnDisconnectDelay</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewWarnDisconnectDelay</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>WarnDisconnectDelay</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetStatusInfo</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewConnectionStatus</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>ConnectionStatus</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLastConnectionError</name>\n"
            + "          <direction>out</direction>\n"
            + "        <relatedStateVariable>LastConnectionError</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewUptime</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>Uptime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetLinkLayerMaxBitRates</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewUpstreamMaxBitRate</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>UpstreamMaxBitRate</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewDownstreamMaxBitRate</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>DownstreamMaxBitRate</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetPPPEncryptionProtocol</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewPPPEncryptionProtocol</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PPPEncryptionProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetPPPCompressionProtocol</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewPPPCompressionProtocol</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PPPCompressionProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetPPPAuthenticationProtocol</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewPPPAuthenticationProtocol</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PPPAuthenticationProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetUserName</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewUserName</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>UserName</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetPassword</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewPassword</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>Password</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetAutoDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewAutoDisconnectTime</name>\n"
            + "          <direction>out</direction>\n"
            + "         <relatedStateVariable>AutoDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetIdleDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewIdleDisconnectTime</name>\n"
            + "          <direction>out</direction>\n"
            + "         <relatedStateVariable>IdleDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetWarnDisconnectDelay</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewWarnDisconnectDelay</name>\n"
            + "          <direction>out</direction>\n"
            + "        <relatedStateVariable>WarnDisconnectDelay</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetNATRSIPStatus</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewRSIPAvailable</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>RSIPAvailable</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewNATEnabled</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>NATEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetGenericPortMappingEntry</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingIndex</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>PortMappingNumberOfEntries</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>out</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalPort</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalClient</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalClient</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewEnabled</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PortMappingEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingDescription</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PortMappingDescription</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLeaseDuration</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PortMappingLeaseDuration</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetSpecificPortMappingEntry </name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalPort</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalClient</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalClient</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewEnabled</name>\n"
            + "          <direction>out</direction>\n"
            + "         <relatedStateVariable>PortMappingEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingDescription</name>\n"
            + "          <direction>out</direction>      \n"
            + "          <relatedStateVariable>PortMappingDescription</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLeaseDuration</name>\n"
            + "          <direction>out</direction>        \n"
            + "          <relatedStateVariable>PortMappingLeaseDuration</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>AddPortMapping </name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>InternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalClient</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>InternalClient</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewEnabled</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>PortMappingEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingDescription</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>PortMappingDescription</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLeaseDuration</name>\n"
            + "          <direction>in</direction>      \n"
            + "          <relatedStateVariable>PortMappingLeaseDuration</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>DeletePortMapping</name>\n"
            + "      <argumentList>\n"
            + "         <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument> \n"
            + "     </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetExternalIPAddress</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewExternalIPAddress</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>ExternalIPAddress</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "  </actionList>\n"
            + "</scpd>";
    
    private static final String WAN_PPP_CONNECTION_WITH_ADDANY
            = "HTTP/1.1 200 OK\r\n"
            + "Content-Type: text/xml\r\n"
            + "\r\n"
            + "<scpd>\n"
            + "    <serviceStateTable>\n"
            + "        <stateVariable>\n"
            + "          <name>ConnectionType</name>\n"
            + "          <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "          <dataType>string</dataType>\n"
            + "        </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PossibleConnectionTypes</name>\n"
            + "      <dataType>string</dataType>\n"
            + "      <allowedValueList>\n"
            + "        <allowedValue>Unconfigured</allowedValue>\n"
            + "        <allowedValue>IP_Routed</allowedValue>\n"
            + "        <allowedValue>DHCP_Spoofed</allowedValue>\n"
            + "        <allowedValue>PPPoE_Bridged</allowedValue>\n"
            + "        <allowedValue>PPTP_Relay</allowedValue>\n"
            + "        <allowedValue>L2TP_Relay</allowedValue>\n"
            + "        <allowedValue>PPPoE_Relay</allowedValue>\n"
            + "      </allowedValueList>      \n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "        <name>ConnectionStatus</name>\n"
            + "        <dataType>string</dataType>\n"
            + "        <allowedValueList>\n"
            + "            <allowedValue>Unconfigured</allowedValue>\n"
            + "            <allowedValue>Connected</allowedValue>\n"
            + "            <allowedValue>Disconnected</allowedValue>\n"
            + "        </allowedValueList>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "\n"
            + "    <stateVariable>\n"
            + "        <name>Uptime</name>\n"
            + "        <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "        <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>UpstreamMaxBitRate</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>DownstreamMaxBitRate</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>LastConnectionError</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "      <allowedValueList>\n"
            + "        <allowedValue>ERROR_NONE</allowedValue>\n"
            + "      </allowedValueList>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "\n"
            + "     <stateVariable>\n"
            + "     <Optional/>\n"
            + "      <name>AutoDisconnectTime</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "    <Optional/>\n"
            + "      <name>IdleDisconnectTime</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "    <Optional/>\n"
            + "      <name>WarnDisconnectDelay</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>RSIPAvailable</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>NATEnabled</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "        \n"
            + "    <stateVariable>\n"
            + "    <Optional/>\n"
            + "      <name>UserName</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "    <Optional/>\n"
            + "      <name>Password</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "        \n"
            + "    <stateVariable>\n"
            + "    <Optional/>\n"
            + "      <name>PPPEncryptionProtocol</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "    <Optional/>\n"
            + "      <name>PPPCompressionProtocol</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "    <Optional/>\n"
            + "      <name>PPPAuthenticationProtocol</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>ExternalIPAddress</name>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingNumberOfEntries</name>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingEnabled</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingLeaseDuration</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>RemoteHost</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>ExternalPort</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>InternalPort</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingProtocol</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "      <allowedValueList>\n"
            + "        <allowedValue>TCP</allowedValue>\n"
            + "	    <allowedValue>UDP</allowedValue>\n"
            + "      </allowedValueList>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>InternalClient</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingDescription</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "  </serviceStateTable>\n"
            + "\n"
            + "  <actionList>\n"
            + "   <action>\n"
            + "    <name>SetConnectionType</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewConnectionType</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ConnectionType</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "     \n"
            + "    <action>\n"
            + "    <name>GetConnectionTypeInfo</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewConnectionType</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>ConnectionType</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPossibleConnectionTypes</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PossibleConnectionTypes</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>ConfigureConnection</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewUserName</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>UserName</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPassword</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>Password</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>RequestConnection</name>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>RequestTermination</name>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>ForceTermination</name>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>SetAutoDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewAutoDisconnectTime</name>\n"
            + "          <direction>in</direction>\n"
            + "         <relatedStateVariable>AutoDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>SetIdleDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewIdleDisconnectTime</name>\n"
            + "          <direction>in</direction>\n"
            + "         <relatedStateVariable>IdleDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>SetWarnDisconnectDelay</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewWarnDisconnectDelay</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>WarnDisconnectDelay</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetStatusInfo</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewConnectionStatus</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>ConnectionStatus</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLastConnectionError</name>\n"
            + "          <direction>out</direction>\n"
            + "        <relatedStateVariable>LastConnectionError</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewUptime</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>Uptime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetLinkLayerMaxBitRates</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewUpstreamMaxBitRate</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>UpstreamMaxBitRate</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewDownstreamMaxBitRate</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>DownstreamMaxBitRate</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetPPPEncryptionProtocol</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewPPPEncryptionProtocol</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PPPEncryptionProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetPPPCompressionProtocol</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewPPPCompressionProtocol</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PPPCompressionProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetPPPAuthenticationProtocol</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewPPPAuthenticationProtocol</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PPPAuthenticationProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetUserName</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewUserName</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>UserName</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetPassword</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewPassword</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>Password</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetAutoDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewAutoDisconnectTime</name>\n"
            + "          <direction>out</direction>\n"
            + "         <relatedStateVariable>AutoDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetIdleDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewIdleDisconnectTime</name>\n"
            + "          <direction>out</direction>\n"
            + "         <relatedStateVariable>IdleDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetWarnDisconnectDelay</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewWarnDisconnectDelay</name>\n"
            + "          <direction>out</direction>\n"
            + "        <relatedStateVariable>WarnDisconnectDelay</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetNATRSIPStatus</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewRSIPAvailable</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>RSIPAvailable</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewNATEnabled</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>NATEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetGenericPortMappingEntry</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingIndex</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>PortMappingNumberOfEntries</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>out</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalPort</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalClient</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalClient</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewEnabled</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PortMappingEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingDescription</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PortMappingDescription</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLeaseDuration</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PortMappingLeaseDuration</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetSpecificPortMappingEntry </name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalPort</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalClient</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalClient</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewEnabled</name>\n"
            + "          <direction>out</direction>\n"
            + "         <relatedStateVariable>PortMappingEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingDescription</name>\n"
            + "          <direction>out</direction>      \n"
            + "          <relatedStateVariable>PortMappingDescription</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLeaseDuration</name>\n"
            + "          <direction>out</direction>        \n"
            + "          <relatedStateVariable>PortMappingLeaseDuration</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>AddPortMapping </name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>InternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalClient</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>InternalClient</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewEnabled</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>PortMappingEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingDescription</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>PortMappingDescription</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLeaseDuration</name>\n"
            + "          <direction>in</direction>      \n"
            + "          <relatedStateVariable>PortMappingLeaseDuration</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>AddAnyPortMapping </name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>InternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalClient</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>InternalClient</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewEnabled</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>PortMappingEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingDescription</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>PortMappingDescription</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLeaseDuration</name>\n"
            + "          <direction>in</direction>      \n"
            + "          <relatedStateVariable>PortMappingLeaseDuration</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>DeletePortMapping</name>\n"
            + "      <argumentList>\n"
            + "         <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument> \n"
            + "     </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetExternalIPAddress</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewExternalIPAddress</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>ExternalIPAddress</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "  </actionList>\n"
            + "</scpd>";

    private static final String WAN_IP_CONNECTION_1
            = "HTTP/1.1 200 OK\r\n"
            + "Content-Type: text/xml\r\n"
            + "\r\n"
            + "<scpd>\n"
            + "\n"
            + "  <serviceStateTable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>ConnectionType</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PossibleConnectionTypes</name>\n"
            + "      <dataType>string</dataType>\n"
            + "      <allowedValueList>\n"
            + "        <allowedValue>Unconfigured</allowedValue>\n"
            + "	    <allowedValue>IP_Routed</allowedValue>\n"
            + "	    <allowedValue>IP_Bridged</allowedValue>\n"
            + "      </allowedValueList>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>ConnectionStatus</name>\n"
            + "      <dataType>string</dataType>\n"
            + "      <allowedValueList>\n"
            + "        <allowedValue>Unconfigured</allowedValue>\n"
            + "	    <allowedValue>Connected</allowedValue>\n"
            + "        <allowedValue>Disconnected</allowedValue>\n"
            + "      </allowedValueList>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>Uptime</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>LastConnectionError</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "      <allowedValueList>\n"
            + "        <allowedValue>ERROR_NONE</allowedValue>\n"
            + "      </allowedValueList>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "     <stateVariable>\n"
            + "      <Optional/>\n"
            + "      <name>AutoDisconnectTime</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <Optional/>\n"
            + "      <name>IdleDisconnectTime</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <Optional/>\n"
            + "      <name>WarnDisconnectDelay</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>RSIPAvailable</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>NATEnabled</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>      \n"
            + "    </stateVariable>\n"
            + "        \n"
            + "    <stateVariable>\n"
            + "      <name>ExternalIPAddress</name>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingNumberOfEntries</name>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingEnabled</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingLeaseDuration</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>RemoteHost</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>ExternalPort</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>InternalPort</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingProtocol</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "      <allowedValueList>\n"
            + "        <allowedValue>TCP</allowedValue>\n"
            + "	    <allowedValue>UDP</allowedValue>\n"
            + "      </allowedValueList>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>InternalClient</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingDescription</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + " </serviceStateTable>\n"
            + "\n"
            + "  <actionList>\n"
            + "\n"
            + "   <action>\n"
            + "    <name>SetConnectionType</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewConnectionType</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ConnectionType</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "     \n"
            + "    <action>\n"
            + "    <name>GetConnectionTypeInfo</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewConnectionType</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>ConnectionType</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPossibleConnectionTypes</name>\n"
            + "          <direction>out</direction>     \n"
            + "          <relatedStateVariable>PossibleConnectionTypes</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>RequestConnection</name>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>RequestTermination</name>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>ForceTermination</name>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>SetAutoDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewAutoDisconnectTime</name>\n"
            + "          <direction>in</direction>\n"
            + "         <relatedStateVariable>AutoDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>SetIdleDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewIdleDisconnectTime</name>\n"
            + "          <direction>in</direction>\n"
            + "         <relatedStateVariable>IdleDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>SetWarnDisconnectDelay</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewWarnDisconnectDelay</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>WarnDisconnectDelay</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetStatusInfo</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewConnectionStatus</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>ConnectionStatus</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLastConnectionError</name>\n"
            + "          <direction>out</direction>\n"
            + "        <relatedStateVariable>LastConnectionError</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewUptime</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>Uptime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetAutoDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewAutoDisconnectTime</name>\n"
            + "          <direction>out</direction>\n"
            + "         <relatedStateVariable>AutoDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetIdleDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewIdleDisconnectTime</name>\n"
            + "          <direction>out</direction>\n"
            + "         <relatedStateVariable>IdleDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetWarnDisconnectDelay</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewWarnDisconnectDelay</name>\n"
            + "          <direction>out</direction>\n"
            + "        <relatedStateVariable>WarnDisconnectDelay</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetNATRSIPStatus</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewRSIPAvailable</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>RSIPAvailable</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewNATEnabled</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>NATEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetGenericPortMappingEntry</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingIndex</name>\n"
            + "          <direction>in</direction>       \n"
            + "          <relatedStateVariable>PortMappingNumberOfEntries</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>out</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalPort</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalClient</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalClient</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewEnabled</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PortMappingEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingDescription</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PortMappingDescription</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLeaseDuration</name>\n"
            + "          <direction>out</direction>     \n"
            + "          <relatedStateVariable>PortMappingLeaseDuration</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetSpecificPortMappingEntry </name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalPort</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalClient</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalClient</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewEnabled</name>\n"
            + "          <direction>out</direction>\n"
            + "         <relatedStateVariable>PortMappingEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingDescription</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PortMappingDescription</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLeaseDuration</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PortMappingLeaseDuration</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>AddPortMapping </name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>InternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalClient</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>InternalClient</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewEnabled</name>\n"
            + "          <direction>in</direction>\n"
            + "         <relatedStateVariable>PortMappingEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingDescription</name>\n"
            + "          <direction>in</direction>      \n"
            + "          <relatedStateVariable>PortMappingDescription</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLeaseDuration</name>\n"
            + "          <direction>in</direction>      \n"
            + "          <relatedStateVariable>PortMappingLeaseDuration</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>DeletePortMapping</name>\n"
            + "      <argumentList>\n"
            + "         <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument> \n"
            + "     </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetExternalIPAddress</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewExternalIPAddress</name>\n"
            + "          <direction>out</direction>\n"
            + "        <relatedStateVariable>ExternalIPAddress</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "  </actionList>\n"
            + "\n"
            + "</scpd>";

    private static final String WAN_IPV6_FIREWALL_CONTROL
            = "HTTP/1.1 200 OK\r\n"
            + "Content-Type: text/xml\r\n"
            + "\r\n"
            + "<scpd>\n"
            + "\n"
            + "  <serviceStateTable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>FirewallEnabled</name>\n"
            + "      <sendEventsAttribute>yes</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>InboundPinholeAllowed</name>\n"
            + "      <sendEventsAttribute>yes</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <Optional/>\n"
            + "      <name>A_ARG_TYPE_OutboundPinholeTimeout</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>A_ARG_TYPE_IPv6Address</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>A_ARG_TYPE_Port</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "     <stateVariable>\n"
            + "      <name>A_ARG_TYPE_Protocol</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>A_ARG_TYPE_LeaseTime</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "      <allowedValueRange>\n"
            + "        <minimum>1</minimum>\n"
            + "        <maximum>86400</maximum>\n"
            + "      </allowedValueRange>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>A_ARG_TYPE_UniqueID</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>A_ARG_TYPE_PinholePackets</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>A_ARG_TYPE_Boolean</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "    \n"
            + " </serviceStateTable>\n"
            + "\n"
            + "  <actionList>\n"
            + "\n"
            + "   <action>\n"
            + "    <name>GetFirewallStatus</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>FirewallEnabled</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>FirewallEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>InboundPinholeAllowed</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InboundPinholeAllowed</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "     \n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetOutboundPinholeTimeout</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>RemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>A_ARG_TYPE_IPv6Address</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>RemotePort</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_Port</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>InternalClient</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_IPv6Address</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>InternalPort</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_Port</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>Protocol</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_Protocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>OutboundPinholeTimeout</name>\n"
            + "          <direction>out</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_OutboundPinholeTimeout</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>AddPinhole</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>RemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>A_ARG_TYPE_IPv6Address</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>RemotePort</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_Port</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>InternalClient</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_IPv6Address</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>InternalPort</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_Port</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>Protocol</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_Protocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>LeaseTime</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_LeaseTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>UniqueID</name>\n"
            + "          <direction>out</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_UniqueID</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>UpdatePinhole</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>UniqueID</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_UniqueID</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLeaseTime</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_LeaseTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>DeletePinhole</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>UniqueID</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_UniqueID</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetPinholePackets</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>UniqueID</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_UniqueID</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>PinholePackets</name>\n"
            + "          <direction>out</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_PinholePackets</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>CheckPinholeWorking</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>UniqueID</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_UniqueID</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>IsWorking</name>\n"
            + "          <direction>out</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_Boolean</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "  </actionList>\n"
            + "\n"
            + "</scpd>";

    private static final String HYBRID_IP_CONNECTION_AND_IPV6_FIREWALL_CONTROL_WITH_FAULTY_XML
            = "HTTP/1.1 200 OK\r\n"
            + "Content-Type: text/xml\r\n"
            + "\r\n"
            + "<scp\n"
            + "\n"
            + "\n"
            + "Table>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>FirewallEnabled</name>\n"
            + "      <sendEventsAttribute>yes</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>InboundPinholeAllowed</name>\n"
            + "      <sendEventsAttribute>yes</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <Optional/>\n"
            + "      <name>A_ARG_TYPE_OutboundPinholeTimeout</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>A_ARG_TYPE_IPv6Address</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>A_ARG_TYPE_Port</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui2</dataType>\n"
            + "      <allowedValueRange>\n"
            + "        <minimum>123</minimum>\n"
            + "        <maximum>500</maximum>\n"
            + "      </allowedValueRange>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "     <stateVariable>\n"
            + "      <name>A_ARG_TYPE_Protocol</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>A_ARG_TYPE_LeaseTime</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "      <allowedValueRange>\n"
            + "        <minimum>1</minimum>\n"
            + "        <maximum>11111</maximum>\n"
            + "      </allowedValueRange>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>A_ARG_TYPE_UniqueID</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>A_ARG_TYPE_PinholePackets</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>A_ARG_TYPE_Boolean</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "    \n"
            + " </serviceStateTable>\n"
            + "\n"
            + "  <actionList>\n"
            + "\n"
            + "   <action>\n"
            + "    <name>GetFirewallStatus</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>FirewallEnabled</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>FirewallEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>InboundPinholeAllowed</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InboundPinholeAllowed</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "     \n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetOutboundPinholeTimeout</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>RemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>A_ARG_TYPE_IPv6Address</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>RemotePort</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_Port</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>InternalClient</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_IPv6Address</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>InternalPort</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_Port</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>Protocol</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_Protocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>OutboundPinholeTimeout</name>\n"
            + "          <direction>out</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_OutboundPinholeTimeout</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>AddPinhole</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>RemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>A_ARG_TYPE_IPv6Address</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>RemotePort</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_Port</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>InternalClient</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_IPv6Address</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>InternalPort</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_Port</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>Protocol</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_Protocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>LeaseTime</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_LeaseTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>UniqueID</name>\n"
            + "          <direction>out</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_UniqueID</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>UpdatePinhole</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>UniqueID</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_UniqueID</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLeaseTime</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_LeaseTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>DeletePinhole</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>UniqueID</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_UniqueID</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetPinholePackets</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>UniqueID</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_UniqueID</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>PinholePackets</name>\n"
            + "          <direction>out</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_PinholePackets</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>CheckPinholeWorking</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>UniqueID</name>\n"
            + "          <direction>in</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_UniqueID</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>IsWorking</name>\n"
            + "          <direction>out</direction>     \n"
            + "          <relatedStateVariable>A_ARG_TYPE_Boolean</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "<scpd>\n"
            + "\n"
            + "  <serviceStateTable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>ConnectionType</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PossibleConnectionTypes</name>\n"
            + "      <dataType>string</dataType>\n"
            + "      <allowedValueList>\n"
            + "        <allowedValue>Unconfigured</allowedValue>\n"
            + "	    <allowedValue>IP_Routed</allowedValue>\n"
            + "	    <allowedValue>IP_Bridged</allowedValue>\n"
            + "      </allowedValueList>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>ConnectionStatus</name>\n"
            + "      <dataType>string</dataType>\n"
            + "      <allowedValueList>\n"
            + "        <allowedValue>Unconfigured</allowedValue>\n"
            + "	    <allowedValue>Connected</allowedValue>\n"
            + "        <allowedValue>Disconnected</allowedValue>\n"
            + "      </allowedValueList>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>Uptime</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>LastConnectionError</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "      <allowedValueList>\n"
            + "        <allowedValue>ERROR_NONE</allowedValue>\n"
            + "      </allowedValueList>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "     <stateVariable>\n"
            + "      <Optional/>\n"
            + "      <name>AutoDisconnectTime</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <Optional/>\n"
            + "      <name>IdleDisconnectTime</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <Optional/>\n"
            + "      <name>WarnDisconnectDelay</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>RSIPAvailable</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>NATEnabled</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>      \n"
            + "    </stateVariable>\n"
            + "        \n"
            + "    <stateVariable>\n"
            + "      <name>ExternalIPAddress</name>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingNumberOfEntries</name>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingEnabled</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>boolean</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingLeaseDuration</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui4</dataType>\n"
            + "      <allowedValueRange>\n"
            + "        <minimum>7</minimum>\n"
            + "        <maximum>1</maximum>\n"
            + "      </allowedValueRange>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>RemoteHost</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>ExternalPort</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui2</dataType>\n"
            + "      <allowedValueRange>\n"
            + "        <minimum>-2</minimum>\n"
            + "        <maximum>-1</maximum>\n"
            + "      </allowedValueRange>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>InternalPort</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>ui2</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingProtocol</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "      <allowedValueList>\n"
            + "        <allowedValue>TCP</allowedValue>\n"
            + "	    <allowedValue>UDP</allowedValue>\n"
            + "      </allowedValueList>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>InternalClient</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + "\n"
            + "    <stateVariable>\n"
            + "      <name>PortMappingDescription</name>\n"
            + "      <sendEventsAttribute>no</sendEventsAttribute>\n"
            + "      <dataType>string</dataType>\n"
            + "    </stateVariable>\n"
            + " </serviceStateTable>\n"
            + "\n"
            + "  <actionList>\n"
            + "\n"
            + "   <action>\n"
            + "    <name>SetConnectionType</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewConnectionType</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ConnectionType</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "     \n"
            + "    <action>\n"
            + "    <name>GetConnectionTypeInfo</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewConnectionType</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>ConnectionType</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPossibleConnectionTypes</name>\n"
            + "          <direction>out</direction>     \n"
            + "          <relatedStateVariable>PossibleConnectionTypes</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>RequestConnection</name>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>RequestTermination</name>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>ForceTermination</name>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>SetAutoDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewAutoDisconnectTime</name>\n"
            + "          <direction>in</direction>\n"
            + "         <relatedStateVariable>AutoDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>SetIdleDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewIdleDisconnectTime</name>\n"
            + "          <direction>in</direction>\n"
            + "         <relatedStateVariable>IdleDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>SetWarnDisconnectDelay</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewWarnDisconnectDelay</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>WarnDisconnectDelay</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetStatusInfo</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewConnectionStatus</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>ConnectionStatus</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLastConnectionError</name>\n"
            + "          <direction>out</direction>\n"
            + "        <relatedStateVariable>LastConnectionError</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewUptime</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>Uptime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetAutoDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewAutoDisconnectTime</name>\n"
            + "          <direction>out</direction>\n"
            + "         <relatedStateVariable>AutoDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetIdleDisconnectTime</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewIdleDisconnectTime</name>\n"
            + "          <direction>out</direction>\n"
            + "         <relatedStateVariable>IdleDisconnectTime</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <Optional/>\n"
            + "    <name>GetWarnDisconnectDelay</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewWarnDisconnectDelay</name>\n"
            + "          <direction>out</direction>\n"
            + "        <relatedStateVariable>WarnDisconnectDelay</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetNATRSIPStatus</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewRSIPAvailable</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>RSIPAvailable</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewNATEnabled</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>NATEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetGenericPortMappingEntry</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingIndex</name>\n"
            + "          <direction>in</direction>       \n"
            + "          <relatedStateVariable>PortMappingNumberOfEntries</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>out</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalPort</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalClient</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalClient</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewEnabled</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PortMappingEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingDescription</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PortMappingDescription</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLeaseDuration</name>\n"
            + "          <direction>out</direction>     \n"
            + "          <relatedStateVariable>PortMappingLeaseDuration</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetSpecificPortMappingEntry </name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalPort</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalClient</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>InternalClient</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewEnabled</name>\n"
            + "          <direction>out</direction>\n"
            + "         <relatedStateVariable>PortMappingEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingDescription</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PortMappingDescription</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLeaseDuration</name>\n"
            + "          <direction>out</direction>\n"
            + "          <relatedStateVariable>PortMappingLeaseDuration</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>AddPortMapping </name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>InternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewInternalClient</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>InternalClient</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewEnabled</name>\n"
            + "          <direction>in</direction>\n"
            + "         <relatedStateVariable>PortMappingEnabled</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewPortMappingDescription</name>\n"
            + "          <direction>in</direction>      \n"
            + "          <relatedStateVariable>PortMappingDescription</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewLeaseDuration</name>\n"
            + "          <direction>in</direction>      \n"
            + "          <relatedStateVariable>PortMappingLeaseDuration</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>DeletePortMapping</name>\n"
            + "      <argumentList>\n"
            + "         <argument>\n"
            + "          <name>NewRemoteHost</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>RemoteHost</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewExternalPort</name>\n"
            + "          <direction>in</direction>\n"
            + "          <relatedStateVariable>ExternalPort</relatedStateVariable>\n"
            + "        </argument>\n"
            + "        <argument>\n"
            + "          <name>NewProtocol</name>\n"
            + "          <direction>in</direction>\n"
            + "        <relatedStateVariable>PortMappingProtocol</relatedStateVariable>\n"
            + "        </argument> \n"
            + "     </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "    <action>\n"
            + "    <name>GetExternalIPAddress</name>\n"
            + "      <argumentList>\n"
            + "        <argument>\n"
            + "          <name>NewExternalIPAddress</name>\n"
            + "          <direction>out</direction>\n"
            + "        <relatedStateVariable>ExternalIPAddress</relatedStateVariable>\n"
            + "        </argument>\n"
            + "      </argumentList>\n"
            + "    </action>\n"
            + "\n"
            + "  </actionList>\n"
            + "\n"
            + "</scpd>"
            + "  </actionList>\n"
            + "\n"
            + "</scpd>";
    
    private static final String EMPTY_CONTENT
            = "HTTP/1.1 200 OK\r\n"
            + "Content-Type: text/xml\r\n"
            + "\r\n";

    @Test
    public void mustProperlyParseWanPppConnection() throws Exception {
        byte[] buffer = WAN_PPP_CONNECTION_1.getBytes("US-ASCII");
        ServiceDescriptionUpnpIgdResponse resp = new ServiceDescriptionUpnpIgdResponse(buffer);

        Map<ServiceType, IdentifiedService> services = resp.getIdentifiedServices();
        assertEquals(1, services.size());
        assertTrue(services.containsKey(ServiceType.OLD_PORT_MAPPER));
        
        IdentifiedService service = services.get(ServiceType.OLD_PORT_MAPPER);
        assertEquals(Range.between(0L, 65535L), service.getExternalPortRange());
        assertEquals(Range.between(1L, 604800L), service.getLeaseDurationRange());
    }

    @Test
    public void mustProperlyParseNewWanPppConnection() throws Exception {
        byte[] buffer = WAN_PPP_CONNECTION_WITH_ADDANY.getBytes("US-ASCII");
        ServiceDescriptionUpnpIgdResponse resp = new ServiceDescriptionUpnpIgdResponse(buffer);

        Map<ServiceType, IdentifiedService> services = resp.getIdentifiedServices();
        assertEquals(1, services.size());
        assertTrue(services.containsKey(ServiceType.NEW_PORT_MAPPER));
        
        IdentifiedService service = services.get(ServiceType.NEW_PORT_MAPPER);
        assertEquals(Range.between(0L, 65535L), service.getExternalPortRange());
        assertEquals(Range.between(1L, 604800L), service.getLeaseDurationRange());
    }

    @Test
    public void mustProperlyParseWanIpConnection() throws Exception {
        byte[] buffer = WAN_IP_CONNECTION_1.getBytes("US-ASCII");
        ServiceDescriptionUpnpIgdResponse resp = new ServiceDescriptionUpnpIgdResponse(buffer);

        Map<ServiceType, IdentifiedService> services = resp.getIdentifiedServices();
        assertEquals(1, services.size());
        assertTrue(services.containsKey(ServiceType.OLD_PORT_MAPPER));
        
        IdentifiedService service = services.get(ServiceType.OLD_PORT_MAPPER);
        assertEquals(Range.between(0L, 65535L), service.getExternalPortRange());
        assertEquals(Range.between(1L, 604800L), service.getLeaseDurationRange());
    }

    @Test
    public void mustProperlyParseWanIpv6FirewallConnection() throws Exception {
        byte[] buffer = WAN_IPV6_FIREWALL_CONTROL.getBytes("US-ASCII");
        ServiceDescriptionUpnpIgdResponse resp = new ServiceDescriptionUpnpIgdResponse(buffer);

        Map<ServiceType, IdentifiedService> services = resp.getIdentifiedServices();
        assertEquals(1, services.size());
        assertTrue(services.containsKey(ServiceType.FIREWALL));
        
        IdentifiedService service = services.get(ServiceType.FIREWALL);
        assertEquals(Range.between(0L, 65535L), service.getExternalPortRange());
        assertEquals(Range.between(1L, 86400L), service.getLeaseDurationRange());
    }

    @Test
    public void mustProperlyParseFaulyHybrid() throws Exception {
        byte[] buffer = HYBRID_IP_CONNECTION_AND_IPV6_FIREWALL_CONTROL_WITH_FAULTY_XML.getBytes("US-ASCII");
        ServiceDescriptionUpnpIgdResponse resp = new ServiceDescriptionUpnpIgdResponse(buffer);

        Map<ServiceType, IdentifiedService> services = resp.getIdentifiedServices();
        assertEquals(2, services.size());
        assertTrue(services.containsKey(ServiceType.OLD_PORT_MAPPER));
        assertTrue(services.containsKey(ServiceType.FIREWALL));

        IdentifiedService service;
        
        service = services.get(ServiceType.OLD_PORT_MAPPER);
        // these are negative and overlapping in XML, so they should be defaults
        assertEquals(Range.between(0L, 65535L), service.getExternalPortRange());
        assertEquals(Range.between(1L, 604800L), service.getLeaseDurationRange());
        
        
        service = services.get(ServiceType.FIREWALL);
        // these are valid
        assertEquals(Range.between(123L, 500L), service.getExternalPortRange());
        assertEquals(Range.between(1L, 11111L), service.getLeaseDurationRange());
    }

    public void mustFailWhenNoServicesIdentified() throws Exception {
        byte[] buffer = EMPTY_CONTENT.getBytes("US-ASCII");
        ServiceDescriptionUpnpIgdResponse resp = new ServiceDescriptionUpnpIgdResponse(buffer);

        Map<ServiceType, IdentifiedService> services = resp.getIdentifiedServices();
        assertEquals(0, services.size());
    }

}
